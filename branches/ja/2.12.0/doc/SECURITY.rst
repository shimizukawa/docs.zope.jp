初期ユーザー名とパスワードの設定
=================================

Zope はWebを通して管理するため、ユーザー名とパスワードは Zope 
のインストールに対して変更を加える権限を与えてもよい人にのみ与える、
ということを確実に行わなければいけません。

通常の管理ユーザーを Zope に登録するための、ユーザーとパスワードが "起動時" 
に必要になります。これは 'inituser' ファイルを通して渡されます。
Zope は一番最初の起動時に、(Zope内の)ルートのユーザーフォルダに
アカウントが一つもないことを検知すると、 'inituser' ファイルを探して、
ファイルがあればそのユーザー定義を(Zope内の)ユーザーフォルダに追加します。

通常、 'inituser' は Zope のインストールスクリプトで作成されます。
インストール時にパスワードの入力を求められるか、自動的にランダムな
パスワードを生成してビルドスクリプトの完了時に表示します。

'zpasswd.py' スクリプトを使えば、 'inituser' を自分で作成することも
できます。 'zpasswd.py' の実行は以下のように行います::

    python zpasswd.py inituser

スクリプトはユーザー名、パスワード、そして許可するドメインの入力を
求めます。デフォルトではパスワードは SHA にエンコードされるので、
パスワードは忘れないようにしてください。パスワードを復元する方法は
ありません。 (あるいは 'zpasswd.py' でパスワードをリセットしてください)

良くある状況として、パスワードを忘れたり、セキュリティー設定を間違える
などのために通常のセキュリティーをバイパスしたいということがあります。
Zope は "emergency user" (緊急ユーザー) という仕組みを提供しており、
この仕組みを使ってパスワードをリセットしたり、正しいセキュリティー設定
にしたり出来ます。

緊急ユーザーのパスワードはアプリケーションの外で定義されます。
'access' という名前のファイルを Zope ディレクトリに置いてください。
このファイルは Zope が稼働するユーザー権限でのみ、読み込めるように
するべきです。

緊急ユーザーを作るには 'zpasswd.py' を使って以下のようにして 'access'
ファイルを作成します::

    python zpasswd.py access

もっと高いセキュリティーの要求がある場合のために、パスワードは
SHA-1 や UNIX crypt などいくつかの異なる方法でエンコードすることが
出来ます(Pythonのコンパイル時に組み込まれている必要があります)。
特別な要求(以下を参照)がなければ、デフォルトの SHA-1 を使うのが
良いでしょう。

'inituser' と 'access' のフォーマット
---------------------------------------

パスワードファイルは以下の形式で1行のみ記載されています::

    name:password

3つ目の要素として、ドメインの制限を付け加えることが出来ます::

    mario:nintendoRules:*.mydomain.com

これで、緊急ユーザーは `*.mydomain.com` からのアクセスのみ許可される
ようになります。この場合、正しい緊急ユーザーの名前とパスワードを使っても、
他のドメインからのアクセスは失敗します。

注意して欲しい点として、 ZServer モニター機能を使用する場合は、
crear text パスワードを使用する必要があるでしょう。

var ディレクトリのパーミッション設定
----------------------------------------

Zope の var ディレクトリのパーミッションを設定する必要があります。
Zope は var ディレクトリに読み書き両方を行う必要があります。
Zope を起動する前に Zope の実行ユーザー権限で var ディレクトリに
アクセスする必要十分な設定をしておいてください。

Zope をどのように実行するかによっては、 var ディレクトリに異なる
パーミッションを設定する必要があるでしょう。既存のサーバーに
入っている Zope を使用する場合などには、おそらく Zope は 'nobody'
権限で動作するでしょうから、この場合は 'nobody' ユーザーに対して
読み書きを許可するように var ディレクトリに設定します。

Zope の実行方法を変更した場合、それに合わせて var ディレクトリと
中のファイルのアクセス権限を設定して、 Zope がそれらのファイルに
新しく設定した userid で読み書き出来るようにしてください。

.. todo:: (Translated by Shimizukawa, `r104646 <http://svn.zope.org/Zope/tags/2.12.0/doc/SECURITY.rst?rev=104646&view=markup>`_, `original-site <http://docs.zope.org/zope2/releases/2.12/SECURITY.html>`_)

